<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>–®–∫–æ–ª—å–Ω—ã–π –ß–∞—Ç</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    :root {
      --bg: #000;
      --card-bg: #111;
      --text: #fff;
      --border: #333;
      --primary: #2563eb;
      --success: #16a34a;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', system-ui, sans-serif;
    }

    html, body {
      background: var(--bg);
      color: var(--text);
      padding: 20px 16px;
      max-width: 100vw;
      overflow-x: hidden;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    .mobile-only {
      display: none;
    }

    .desktop-message {
      text-align: center;
      padding: 40px;
      max-width: 500px;
    }

    .desktop-message h1 {
      font-size: 24px;
      margin-bottom: 20px;
      color: #3b82f6;
      letter-spacing: 1px;
    }

    .desktop-message p {
      font-size: 18px;
      margin-bottom: 30px;
      color: #10b981;
      font-weight: bold;
    }

    .qr-container {
      background: rgba(31, 41, 55, 0.7);
      border-radius: 16px;
      padding: 20px;
      display: inline-block;
    }

    .qr-code {
      width: 200px;
      height: 200px;
      background: white;
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 0 20px rgba(0, 255, 128, 0.2);
    }

    .qr-code img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* –î–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ */
    @media (max-width: 768px) {
      .desktop-message {
        display: none;
      }

      .mobile-only {
        display: block;
        width: 100%;
        max-width: 500px;
        margin: 0 auto;
      }

      .container {
        padding: 20px;
      }
    }
  </style>
</head>
<body>
  <!-- –≠–∫—Ä–∞–Ω –¥–ª—è –ü–ö -->
  <div class="desktop-message">
    <h1>üì± –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ —Å –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏</h1>
    <p>–û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR-–∫–æ–¥ –≤ Telegram, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –®–∫–æ–ª—å–Ω—ã–π –ß–∞—Ç</p>
    <div class="qr-container">
      <div class="qr-code">
        <!-- –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å QR-–∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤–µ–¥—ë—Ç –Ω–∞ –≤–∞—à –±–æ—Ç –∏–ª–∏ Mini App -->
        <!-- –ù–∞–ø—Ä–∏–º–µ—Ä, QR-–∫–æ–¥ —Å URL –≤–∞—à–µ–≥–æ –±–æ—Ç–∞: https://t.me/your_bot_name -->
        <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiB2aWV3Qm94PSIwIDAgMjAwIDIwMCI+PHJlY3Qgd2lkdGg9IjIwMCIgaGVpZ2h0PSIyMDAiIGZpbGw9IndoaXRlIi8+PC9zdmc+" alt="QR Code">
      </div>
    </div>
  </div>

  <!-- –≠–∫—Ä–∞–Ω –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ -->
  <div class="mobile-only">
    <div class="container">
      <div class="header">
        <h1>üì® –®–∫–æ–ª—å–Ω—ã–π –ß–∞—Ç</h1>
      </div>

      <div class="section">
        <div class="section-title">1. –ö–∞—Ç–µ–≥–æ—Ä–∏—è</div>
        <div class="categories">
          <button class="category-btn active" data-type="idea"><i class="fas fa-lightbulb"></i> –ò–¥–µ—è</button>
          <button class="category-btn" data-type="question"><i class="fas fa-question-circle"></i> –í–æ–ø—Ä–æ—Å</button>
          <button class="category-btn" data-type="complaint"><i class="fas fa-exclamation-triangle"></i> –ü—Ä–æ–±–ª–µ–º–∞</button>
        </div>
      </div>

      <div class="section">
        <div class="section-title">2. –¢–µ–∫—Å—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è</div>
        <textarea id="text" placeholder="–û–ø–∏—à–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ..."></textarea>
      </div>

      <button id="send" class="send-btn">‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </div>
  </div>

  <script>
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –º–æ–±–∏–ª—å–Ω–æ–µ –ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
    const isMobile = /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

    if (!isMobile) {
      // –ï—Å–ª–∏ –Ω–µ –º–æ–±–∏–ª—å–Ω–æ–µ ‚Äî —Å–∫—Ä—ã–≤–∞–µ–º –º–æ–±–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
      document.querySelector('.mobile-only').style.display = 'none';
    } else {
      // –ï—Å–ª–∏ –º–æ–±–∏–ª—å–Ω–æ–µ ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Telegram WebApp
      if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
        Telegram.WebApp.ready();
        Telegram.WebApp.expand();
        Telegram.WebApp.setHeaderColor('#000000');
        Telegram.WebApp.setBackgroundColor('#000000');
      }

      // –ê–Ω–æ–Ω–∏–º–Ω—ã–π ID
      let anonId = localStorage.getItem('schoolChatAnonId');
      if (!anonId) {
        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
        anonId = 'STU-' + Array.from({length: 6}, () => chars[Math.random() * chars.length | 0]).join('');
        localStorage.setItem('schoolChatAnonId', anonId);
      }

      // –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
      let category = 'idea';
      const categoryButtons = document.querySelectorAll('.category-btn');
      categoryButtons.forEach(btn => {
        btn.addEventListener('pointerup', () => {
          categoryButtons.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          category = btn.dataset.type;
        });
      });

      // –û—Ç–ø—Ä–∞–≤–∫–∞
      const sendBtn = document.getElementById('send');
      const textArea = document.getElementById('text');

      sendBtn.addEventListener('pointerup', () => {
        const text = textArea.value.trim();
        if (!text) {
          if (Telegram?.WebApp) {
            Telegram.WebApp.showAlert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è.');
          }
          return;
        }

        const data = {
          action: 'submit',
          anonymous_id: anonId,
          type: category,
          text: text
        };

        if (Telegram?.WebApp) {
          Telegram.WebApp.sendData(JSON.stringify(data));
        }
      });
    }
  </script>
</body>
</html>
